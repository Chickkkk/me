<!DOCTYPE html><html  lang="zh-CN" class="h-full"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style id="nuxt-ui-colors">@layer base {
  :root {
  --ui-color-primary-50: var(--color-purple-50, oklch(97.7% 0.014 308.299));
  --ui-color-primary-100: var(--color-purple-100, oklch(94.6% 0.033 307.174));
  --ui-color-primary-200: var(--color-purple-200, oklch(90.2% 0.063 306.703));
  --ui-color-primary-300: var(--color-purple-300, oklch(82.7% 0.119 306.383));
  --ui-color-primary-400: var(--color-purple-400, oklch(71.4% 0.203 305.504));
  --ui-color-primary-500: var(--color-purple-500, oklch(62.7% 0.265 303.9));
  --ui-color-primary-600: var(--color-purple-600, oklch(55.8% 0.288 302.321));
  --ui-color-primary-700: var(--color-purple-700, oklch(49.6% 0.265 301.924));
  --ui-color-primary-800: var(--color-purple-800, oklch(43.8% 0.218 303.724));
  --ui-color-primary-900: var(--color-purple-900, oklch(38.1% 0.176 304.987));
  --ui-color-primary-950: var(--color-purple-950, oklch(29.1% 0.149 302.717));
  --ui-color-secondary-50: var(--color-blue-50, oklch(97% 0.014 254.604));
  --ui-color-secondary-100: var(--color-blue-100, oklch(93.2% 0.032 255.585));
  --ui-color-secondary-200: var(--color-blue-200, oklch(88.2% 0.059 254.128));
  --ui-color-secondary-300: var(--color-blue-300, oklch(80.9% 0.105 251.813));
  --ui-color-secondary-400: var(--color-blue-400, oklch(70.7% 0.165 254.624));
  --ui-color-secondary-500: var(--color-blue-500, oklch(62.3% 0.214 259.815));
  --ui-color-secondary-600: var(--color-blue-600, oklch(54.6% 0.245 262.881));
  --ui-color-secondary-700: var(--color-blue-700, oklch(48.8% 0.243 264.376));
  --ui-color-secondary-800: var(--color-blue-800, oklch(42.4% 0.199 265.638));
  --ui-color-secondary-900: var(--color-blue-900, oklch(37.9% 0.146 265.522));
  --ui-color-secondary-950: var(--color-blue-950, oklch(28.2% 0.091 267.935));
  --ui-color-warning-50: var(--color-yellow-50, oklch(98.7% 0.026 102.212));
  --ui-color-warning-100: var(--color-yellow-100, oklch(97.3% 0.071 103.193));
  --ui-color-warning-200: var(--color-yellow-200, oklch(94.5% 0.129 101.54));
  --ui-color-warning-300: var(--color-yellow-300, oklch(90.5% 0.182 98.111));
  --ui-color-warning-400: var(--color-yellow-400, oklch(85.2% 0.199 91.936));
  --ui-color-warning-500: var(--color-yellow-500, oklch(79.5% 0.184 86.047));
  --ui-color-warning-600: var(--color-yellow-600, oklch(68.1% 0.162 75.834));
  --ui-color-warning-700: var(--color-yellow-700, oklch(55.4% 0.135 66.442));
  --ui-color-warning-800: var(--color-yellow-800, oklch(47.6% 0.114 61.907));
  --ui-color-warning-900: var(--color-yellow-900, oklch(42.1% 0.095 57.708));
  --ui-color-warning-950: var(--color-yellow-950, oklch(28.6% 0.066 53.813));
  --ui-color-error-50: var(--color-red-50, oklch(97.1% 0.013 17.38));
  --ui-color-error-100: var(--color-red-100, oklch(93.6% 0.032 17.717));
  --ui-color-error-200: var(--color-red-200, oklch(88.5% 0.062 18.334));
  --ui-color-error-300: var(--color-red-300, oklch(80.8% 0.114 19.571));
  --ui-color-error-400: var(--color-red-400, oklch(70.4% 0.191 22.216));
  --ui-color-error-500: var(--color-red-500, oklch(63.7% 0.237 25.331));
  --ui-color-error-600: var(--color-red-600, oklch(57.7% 0.245 27.325));
  --ui-color-error-700: var(--color-red-700, oklch(50.5% 0.213 27.518));
  --ui-color-error-800: var(--color-red-800, oklch(44.4% 0.177 26.899));
  --ui-color-error-900: var(--color-red-900, oklch(39.6% 0.141 25.723));
  --ui-color-error-950: var(--color-red-950, oklch(25.8% 0.092 26.042));
  --ui-color-neutral-50: var(--color-old-neutral-50, oklch(98.5% 0 0));
  --ui-color-neutral-100: var(--color-old-neutral-100, oklch(97% 0 0));
  --ui-color-neutral-200: var(--color-old-neutral-200, oklch(92.2% 0 0));
  --ui-color-neutral-300: var(--color-old-neutral-300, oklch(87% 0 0));
  --ui-color-neutral-400: var(--color-old-neutral-400, oklch(70.8% 0 0));
  --ui-color-neutral-500: var(--color-old-neutral-500, oklch(55.6% 0 0));
  --ui-color-neutral-600: var(--color-old-neutral-600, oklch(43.9% 0 0));
  --ui-color-neutral-700: var(--color-old-neutral-700, oklch(37.1% 0 0));
  --ui-color-neutral-800: var(--color-old-neutral-800, oklch(26.9% 0 0));
  --ui-color-neutral-900: var(--color-old-neutral-900, oklch(20.5% 0 0));
  --ui-color-neutral-950: var(--color-old-neutral-950, oklch(14.5% 0 0));
  }
  :root, .light {
  --ui-primary: var(--ui-color-primary-500);
  --ui-secondary: var(--ui-color-secondary-500);
  --ui-warning: var(--ui-color-warning-500);
  --ui-error: var(--ui-color-error-500);
  }
  .dark {
  --ui-primary: var(--ui-color-primary-400);
  --ui-secondary: var(--ui-color-secondary-400);
  --ui-warning: var(--ui-color-warning-400);
  --ui-error: var(--ui-color-error-400);
  }
}</style><style>pre code .line{display:block}</style><link rel="stylesheet" href="/_nuxt/entry.D2cyCOem.css" crossorigin><style>@layer components {:where(.i-heroicons\:book-open-solid){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M11.25 4.533A9.7 9.7 0 0 0 6 3a9.7 9.7 0 0 0-3.25.555a.75.75 0 0 0-.5.707v14.25a.75.75 0 0 0 1 .707A8.2 8.2 0 0 1 6 18.75c1.995 0 3.823.707 5.25 1.886zm1.5 16.103A8.2 8.2 0 0 1 18 18.75c.966 0 1.89.166 2.75.47a.75.75 0 0 0 1-.708V4.262a.75.75 0 0 0-.5-.707A9.7 9.7 0 0 0 18 3a9.7 9.7 0 0 0-5.25 1.533z'/%3E%3C/svg%3E")}:where(.i-heroicons\:home-20-solid){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' width='20' height='20'%3E%3Cpath fill='black' fill-rule='evenodd' d='M9.293 2.293a1 1 0 0 1 1.414 0l7 7A1 1 0 0 1 17 11h-1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6H3a1 1 0 0 1-.707-1.707z' clip-rule='evenodd'/%3E%3C/svg%3E")}}</style><link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/202504/intersectionobserver-watch-dom/_payload.json?c64855ae-f368-40ba-a374-4b3dd8e64b35"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BRIe8boL.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CzFKWOfP.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CLDzsHb4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DcXHlgnW.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/xYQYW_UD.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CKM8n8xN.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/FWExn44w.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BN-Yn-ZC.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DHZ5y-dm.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C4M_j2C3.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DbRRPepl.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Y6-_QNPY.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/6gTviMOt.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ce3P4x3O.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DJf8ZPNY.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/2wGA7Zv2.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/c64855ae-f368-40ba-a374-4b3dd8e64b35.json"><link rel="prefetch" as="style" crossorigin href="/_nuxt/index.B1FApBYP.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BAIBR0rT.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DaiY0WcB.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CApyblPo.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/D0ZgY2X0.js"><script type="module" src="/_nuxt/BRIe8boL.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt" class="isolate"><!--[--><!--[--><!--[--><!--[--><!--[--><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><div style="" class="limit fixed top-0 right-0 left-0 z-50"><!--[--><!----><!----><nav aria-label="Main" data-orientation="horizontal" dir="ltr" data-reka-navigation-menu data-collapsed="false" class="relative gap-1.5 [&amp;&gt;div]:min-w-0 justify-between my-4 flex items-center text-sm font-medium text-neutral-800 rounded-full shadow-lg bg-white/90 shadow-neutral-800/5 ring-1 backdrop-blur dark:bg-neutral-800/90 dark:text-neutral-200 dark:ring-white/20 ring-neutral-900/5"><!--[--><!--[--><!--[--><div style="position:relative;"><ul class="isolate min-w-0 flex items-center" data-orientation="horizontal"><!--[--><!--[--><li data-menu-item class="min-w-0 py-2"><!--[--><!--[--><a href="/" class="group relative w-full flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none dark:focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-(--ui-primary) px-2.5 py-1.5 before:inset-x-px before:inset-y-0 text-(--ui-text-muted) after:absolute after:-bottom-2 after:inset-x-2.5 after:block after:h-px after:rounded-full after:transition-colors hover:text-(--ui-text-highlighted) transition-colors data-[state=open]:text-(--ui-text-highlighted) font-bold" data-reka-collection-item><!--[--><!--[--><!--[--><span class="iconify i-heroicons:home-20-solid shrink-0 size-5 text-(--ui-text-dimmed) group-hover:text-(--ui-text) transition-colors group-data-[state=open]:text-(--ui-text)" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Home<!--]--><!----></span><!----><!--]--><!--]--></a><!----><!--]--><!--]--></li><li data-menu-item class="min-w-0 py-2"><!--[--><!--[--><a href="/blog" class="group relative w-full flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none dark:focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-(--ui-primary) px-2.5 py-1.5 before:inset-x-px before:inset-y-0 text-(--ui-text-muted) after:absolute after:-bottom-2 after:inset-x-2.5 after:block after:h-px after:rounded-full after:transition-colors hover:text-(--ui-text-highlighted) transition-colors data-[state=open]:text-(--ui-text-highlighted) font-bold" data-reka-collection-item><!--[--><!--[--><!--[--><span class="iconify i-heroicons:book-open-solid shrink-0 size-5 text-(--ui-text-dimmed) group-hover:text-(--ui-text) transition-colors group-data-[state=open]:text-(--ui-text)" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Blog<!--]--><!----></span><!----><!--]--><!--]--></a><!----><!--]--><!--]--></li><!--]--><!--]--></ul></div><!----><!--]--><!--[--><div style="position:relative;"><ul class="isolate min-w-0 flex items-center" data-orientation="horizontal"><!--[--><!--[--><li data-menu-item class="min-w-0 py-2"><!--[--><!--[--><!--[--><button type="button" class="group relative w-full flex items-center gap-1.5 font-medium text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none dark:focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-(--ui-primary) px-2.5 py-1.5 before:inset-x-px before:inset-y-0 text-(--ui-text-muted) after:absolute after:-bottom-2 after:inset-x-2.5 after:block after:h-px after:rounded-full after:transition-colors hover:text-(--ui-text-highlighted) transition-colors data-[state=open]:text-(--ui-text-highlighted)" data-reka-collection-item><!--[--><!--[--><span></span><!--]--><!--]--></button><!----><!--]--><!--]--><!--]--></li><!--]--><!--]--></ul></div><!----><!--]--><!--]--><div class="absolute top-full left-0 flex w-full justify-center"><!----><!----></div><!--]--></nav><!--]--></div><div class="h-32"></div><div class="w-full mx-auto px-4 sm:px-6 lg:px-8 max-w-2xl min-h-screen"><!--[--><!--[--><div class="blog"><!--[--><article class="prose dark:prose-invert prose-neutral max-w-none prose-a:no-underline"><h1 id="intersectionobserver观察元素是否可见"><!--[-->IntersectionObserver观察元素是否可见<!--]--></h1><h1 id="说明"><!--[-->说明<!--]--></h1><p><!--[-->网页开发时，常常需要了解某个元素是否进入了&quot;视口&quot;（viewport），即用户能不能看到它，IntersectionObserver API，可以自动&quot;观察&quot;元素是否可见，Chrome 51+ 已经支持。由于可见（visible）的本质是，目标元素与视口产生一个交叉区，所以这个 API 叫做&quot;交叉观察器&quot;。<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt data-nuxt-img srcset="https://cloud.qkun.fun/fun/article/1746428536211001.gif 1x, https://cloud.qkun.fun/fun/article/1746428536211001.gif 2x" src="https://cloud.qkun.fun/fun/article/1746428536211001.gif"><!--]--></p><h1 id="创建"><!--[-->创建<!--]--></h1><ol><!--[--><li><!--[-->创建一个 IntersectionObserver 对象，并传入相应参数和回调用函数，该回调函数将会在目标(<code><!--[-->target<!--]--></code>)元素和根(<code><!--[-->root<!--]--></code>)元素的交集大小超过阈值(<code><!--[-->threshold<!--]--></code>)规定的大小时候被执行。<!--]--></li><!--]--></ol><pre class="language-js shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="s8I54">const</span><span class="sXTEK"> ob</span><span class="soRP2"> =</span><span class="s8I54"> new</span><span class="scd8n"> IntersectionObserver</span><span class="sybYZ">(</span><span class="sVbU4">callback</span><span class="sybYZ">,</span><span class="sVbU4"> option</span><span class="sybYZ">)
</span></span></code><!--]--></pre><blockquote><!--[--><ol><!--[--><li><!--[-->callback: 交叉改变后运行： 交叉/不交叉 =&gt; 不交叉/交叉<!--]--></li><li><!--[-->option: 配置项目<!--]--></li><!--]--></ol><ul><!--[--><li><!--[--><code><!--[-->root<!--]--></code>: 指定根(<code><!--[-->root<!--]--></code>)元素，用于检查目标的可见性。必须是目标元素的父级元素。如果未指定或者为<code><!--[-->null<!--]--></code>，则默认为浏览器视窗。<!--]--></li><li><!--[--><code><!--[-->rootMargin<!--]--></code>: 根(<code><!--[-->root<!--]--></code>)元素的外边距。类似于 CSS 中的 margin 属性，比如 &quot;10px 20px 30px 40px&quot; (top, right, bottom, left)。如果有指定 root 参数，则 rootMargin 也可以使用百分比来取值。该属性值是用作 root 元素和 target 发生交集时候的计算交集的区域范围，使用该属性可以控制 root 元素每一边的<code><!--[-->收缩<!--]--></code>或者<code><!--[-->扩张<!--]--></code>。默认值为 0。<!--]--></li><li><!--[--><code><!--[-->threshold<!--]--></code>: 阈值！可以是单一的 number 也可以是 number 数组，target 元素和 root 元素相交程度达到该值的时候 IntersectionObserver 注册的回调函数将会被执行。如果你只是想要探测当 target 元素的在 root 元素中的可见性超过 50%的时候，你可以指定该属性值为 0.5。如果你想要 target 元素在 root 元素的可见程度每多 25%就执行一次回调，那么你可以指定一个数组<span>0, 0.25, 0.5, 0.75, 1</span>。默认值是 0(意味着只要有一个 target 像素出现在 root 元素中，回调函数将会被执行)。该值为 1.0 含义是当 target 完全出现在 root 元素中时候 回调才会被执行。<!--]--></li><!--]--></ul><!--]--></blockquote><ol start="2"><!--[--><li><!--[-->IntersectionObserver Entry<!--]--></li><!--]--></ol><p><!--[-->IntersectionObserverEntry 对象提供了目标元素与跟元素相交的详细信息。他有如下几个属性。<!--]--></p><pre class="language-typescript shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="s8I54">interface</span><span class="s3iJD"> IntersectionObserverEntry</span><span class="sybYZ"> {
</span></span><span class="line" line="2"><span class="s8I54">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> DOMHighResTimeStamp</span><span class="sSfpy"> time</span><span class="sybYZ">;
</span></span><span class="line" line="3"><span class="s8I54">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> DOMRectReadOnly</span><span class="s8I54">?</span><span class="sVbU4"> rootBounds</span><span class="s3cgb">;
</span></span><span class="line" line="4"><span class="sVbU4">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> DOMRectReadOnly</span><span class="sVbU4"> boundingClientRect</span><span class="s3cgb">;
</span></span><span class="line" line="5"><span class="sVbU4">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> DOMRectReadOnly</span><span class="sVbU4"> intersectionRect</span><span class="s3cgb">;
</span></span><span class="line" line="6"><span class="sVbU4">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> boolean</span><span class="sVbU4"> isIntersecting</span><span class="s3cgb">;
</span></span><span class="line" line="7"><span class="sVbU4">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> double</span><span class="sVbU4"> intersectionRatio</span><span class="s3cgb">;
</span></span><span class="line" line="8"><span class="sVbU4">  readonly</span><span class="sVbU4"> attribute</span><span class="sVbU4"> Element</span><span class="sVbU4"> target</span><span class="s3cgb">;
</span></span><span class="line" line="9"><span class="s3cgb">};
</span></span></code><!--]--></pre><ul><!--[--><li><!--[-->time：发生相交到相应的时间，毫秒。<!--]--></li><li><!--[-->rootBounds：根元素矩形区域的信息，如果没有设置根元素则返回 null，图中蓝色部分区域。<!--]--></li><li><!--[-->boundingClientRect：目标元素的矩形区域的信息，图中黑色边框的区域。<!--]--></li><li><!--[-->intersectionRect：目标元素与视口（或根元素）的交叉区域的信息，图中蓝色方块和粉红色方块相交的区域。<!--]--></li><li><!--[-->isIntersecting：<strong><!--[-->目标元素与根元素是否相交(满足预设的阈值条件)<!--]--></strong><!--]--></li><li><!--[-->intersectionRatio：目标元素与视口（或根元素）的相交比例。<!--]--></li><li><!--[-->target：目标元素，图中黑色边框的部分。<!--]--></li><!--]--></ul><pre class="language-js shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="s8I54">var</span><span class="sVbU4"> observer</span><span class="soRP2"> =</span><span class="s8I54"> new</span><span class="scd8n"> IntersectionObserver</span><span class="sybYZ">((</span><span class="sSfpy">entries</span><span class="sybYZ">)</span><span class="soRP2"> =&gt;</span><span class="sybYZ"> {
</span></span><span class="line" line="2"><span class="scBr_">  for</span><span class="sybYZ"> (</span><span class="s8I54">const</span><span class="sXTEK"> entry</span><span class="s8I54"> of</span><span class="sVbU4"> entries</span><span class="sybYZ">)</span><span class="sybYZ"> {
</span></span><span class="line" line="3"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">time</span><span class="sybYZ">)</span><span class="sKXKF"> // 发生变化的时间
</span></span><span class="line" line="4"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">rootBounds</span><span class="sybYZ">)</span><span class="sKXKF"> // 根元素的矩形区域的信息
</span></span><span class="line" line="5"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">boundingClientRect</span><span class="sybYZ">)</span><span class="sKXKF"> // 目标元素的矩形区域的信息
</span></span><span class="line" line="6"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">isIntersection</span><span class="sybYZ">)</span><span class="sKXKF"> // 目标元素与视口（或根元素）是否相交(满足预设的阈值条件)
</span></span><span class="line" line="7"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">intersectionRect</span><span class="sybYZ">)</span><span class="sKXKF"> // 目标元素与视口（或根元素）的交叉区域的信息
</span></span><span class="line" line="8"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">intersectionRatio</span><span class="sybYZ">)</span><span class="sKXKF"> // 目标元素与视口（或根元素）的相交比例
</span></span><span class="line" line="9"><span class="sVbU4">    console</span><span class="sybYZ">.</span><span class="scd8n">log</span><span class="sybYZ">(</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">target</span><span class="sybYZ">)</span><span class="sKXKF"> // 被观察的目标元素
</span></span><span class="line" line="10"><span class="sybYZ">  }
</span></span><span class="line" line="11"><span class="sybYZ">},</span><span class="sybYZ"> {})
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span class="sKXKF">// 开始观察某个目标元素
</span></span><span class="line" line="14"><span class="sVbU4">observer</span><span class="sybYZ">.</span><span class="scd8n">observe</span><span class="sybYZ">(</span><span class="sVbU4">target</span><span class="sybYZ">)
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span class="sKXKF">// 停止观察某个目标元素
</span></span><span class="line" line="17"><span class="sVbU4">observer</span><span class="sybYZ">.</span><span class="scd8n">unobserve</span><span class="sybYZ">(</span><span class="sVbU4">target</span><span class="sybYZ">)
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span class="sKXKF">// 关闭监视器
</span></span><span class="line" line="20"><span class="sVbU4">observer</span><span class="sybYZ">.</span><span class="scd8n">disconnect</span><span class="sybYZ">()
</span></span><span class="line" line="21"><span emptylineplaceholder="true">
</span></span><span class="line" line="22"><span class="sKXKF">// 获取所有 IntersectionObserver 观察的 targets
</span></span><span class="line" line="23"><span class="sVbU4">observer</span><span class="sybYZ">.</span><span class="scd8n">takeRecords</span><span class="sybYZ">()
</span></span></code><!--]--></pre><p><!--[-->请留意，你注册的回调函数将会在主线程中被执行。所以该函数执行速度要尽可能的快。如果有一些耗时的操作需要执行，建议使用 <code><!--[-->Window.requestIdleCallback()<!--]--></code> 方法。<!--]--></p><p><!--[-->所有区域均被 Intersection Observer API 当做一个矩形看待。如果元素是不规则的图形也将会被看成一个包含元素所有区域的最小矩形，相似的，如果元素发生的交集部分不是一个矩形，那么也会被看作是一个包含他所有交集区域的最小矩形。<!--]--></p><p><!--[-->这个有助于理解 IntersectionObserverEntry 的属性，IntersectionObserverEntry 用于描述 <code><!--[-->target<!--]--></code> 和 <code><!--[-->root<!--]--></code> 的交集。<!--]--></p><h1 id="应用"><!--[-->应用<!--]--></h1><h2 id="图片懒加载"><a href="#图片懒加载"><!--[-->图片懒加载<!--]--></a></h2><pre class="language-html shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="sKXKF">&lt;!-- html --&gt;
</span></span><span class="line" line="2"><span class="sybYZ">&lt;</span><span class="s-bR0">img</span><span class="skT8L"> src</span><span class="sybYZ">=</span><span class="sajHj">&#39;</span><span class="sx1Rn">default.png</span><span class="sajHj">&#39;</span><span class="skT8L"> data-src</span><span class="sybYZ">=</span><span class="sajHj">&quot;</span><span class="sx1Rn">xxxxx</span><span class="sajHj">&quot;</span><span class="sybYZ"> /&gt;
</span></span><span class="line" line="3"><span class="sybYZ">&lt;</span><span class="s-bR0">img</span><span class="skT8L"> src</span><span class="sybYZ">=</span><span class="sajHj">&#39;</span><span class="sx1Rn">default.png</span><span class="sajHj">&#39;</span><span class="skT8L"> data-src</span><span class="sybYZ">=</span><span class="sajHj">&quot;</span><span class="sx1Rn">xxxxx</span><span class="sajHj">&quot;</span><span class="sybYZ"> /&gt;
</span></span><span class="line" line="4"><span class="sybYZ">&lt;</span><span class="s-bR0">img</span><span class="skT8L"> src</span><span class="sybYZ">=</span><span class="sajHj">&#39;</span><span class="sx1Rn">default.png</span><span class="sajHj">&#39;</span><span class="skT8L"> data-src</span><span class="sybYZ">=</span><span class="sajHj">&quot;</span><span class="sx1Rn">xxxxx</span><span class="sajHj">&quot;</span><span class="sybYZ"> /&gt;
</span></span><span class="line" line="5"><span class="sybYZ">&lt;</span><span class="s-bR0">img</span><span class="skT8L"> src</span><span class="sybYZ">=</span><span class="sajHj">&#39;</span><span class="sx1Rn">default.png</span><span class="sajHj">&#39;</span><span class="skT8L"> data-src</span><span class="sybYZ">=</span><span class="sajHj">&quot;</span><span class="sx1Rn">xxxxx</span><span class="sajHj">&quot;</span><span class="sybYZ"> /&gt;
</span></span></code><!--]--></pre><pre class="language-js shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="sKXKF">// js
</span></span><span class="line" line="2"><span class="s8I54">const</span><span class="sXTEK"> ob</span><span class="soRP2"> =</span><span class="s8I54"> new</span><span class="scd8n"> IntersectionObserver</span><span class="sybYZ">(
</span></span><span class="line" line="3"><span class="sSfpy">  entries</span><span class="soRP2"> =&gt;</span><span class="sybYZ"> {
</span></span><span class="line" line="4"><span class="scBr_">    for</span><span class="sybYZ"> (</span><span class="s8I54">const</span><span class="sXTEK"> entry</span><span class="s8I54"> of</span><span class="sVbU4"> entries</span><span class="sybYZ">)</span><span class="sybYZ"> {
</span></span><span class="line" line="5"><span class="scBr_">      if</span><span class="sybYZ"> (</span><span class="sVbU4">entry</span><span class="sybYZ">.</span><span class="sVbU4">isIntersecting</span><span class="sybYZ">)</span><span class="sybYZ"> {
</span></span><span class="line" line="6"><span class="s8I54">        const</span><span class="sXTEK"> img</span><span class="soRP2"> =</span><span class="sVbU4"> entry</span><span class="sybYZ">.</span><span class="sVbU4">target</span><span class="sybYZ">;
</span></span><span class="line" line="7"><span class="sVbU4">        img</span><span class="sybYZ">.</span><span class="sVbU4">src</span><span class="soRP2"> =</span><span class="sVbU4"> img</span><span class="sybYZ">.</span><span class="sVbU4">dataset</span><span class="sybYZ">.</span><span class="sVbU4">src</span><span class="sybYZ">;
</span></span><span class="line" line="8"><span class="sVbU4">        ob</span><span class="sybYZ">.</span><span class="scd8n">unobserve</span><span class="sybYZ">(</span><span class="sVbU4">img</span><span class="sybYZ">);
</span></span><span class="line" line="9"><span class="sybYZ">      }
</span></span><span class="line" line="10"><span class="sybYZ">    }
</span></span><span class="line" line="11"><span class="sybYZ">  },
</span></span><span class="line" line="12"><span class="sybYZ">  {
</span></span><span class="line" line="13"><span class="sqmIX">    root</span><span class="sybYZ">:</span><span class="smuiB"> null</span><span class="sybYZ">,
</span></span><span class="line" line="14"><span class="sqmIX">    rootMargin</span><span class="sybYZ">:</span><span class="svno3"> 0</span><span class="sybYZ">,
</span></span><span class="line" line="15"><span class="sqmIX">    threshold</span><span class="sybYZ">:</span><span class="svno3"> 0
</span></span><span class="line" line="16"><span class="sybYZ">  }
</span></span><span class="line" line="17"><span class="sybYZ">);
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span class="s8I54">const</span><span class="sXTEK"> imgs</span><span class="soRP2"> =</span><span class="sVbU4"> document</span><span class="sybYZ">.</span><span class="scd8n">querySelectorAll</span><span class="sybYZ">(</span><span class="sajHj">&#39;</span><span class="sx1Rn">img[data-src]</span><span class="sajHj">&#39;</span><span class="sybYZ">)
</span></span><span class="line" line="20"><span class="sVbU4">imgs</span><span class="sybYZ">.</span><span class="scd8n">forEach</span><span class="sybYZ">(</span><span class="sSfpy">img</span><span class="soRP2"> =&gt;</span><span class="sybYZ"> {
</span></span><span class="line" line="21"><span class="sVbU4">  ob</span><span class="sybYZ">.</span><span class="scd8n">observe</span><span class="sybYZ">(</span><span class="sVbU4">img</span><span class="sybYZ">)
</span></span><span class="line" line="22"><span class="sybYZ">})
</span></span></code><!--]--></pre><h2 id="下拉加载更多"><a href="#下拉加载更多"><!--[-->下拉加载更多<!--]--></a></h2><p><!--[-->方式：在dom元素之下存在一个加载动画。当加载动画出现在视口中，继续添加dom元素<!--]--></p><pre class="language-html shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="sybYZ">  &lt;</span><span class="s-bR0">div</span><span class="sybYZ">&gt;
</span></span><span class="line" line="2"><span class="s3cgb">    // 省略其他dom元素...
</span></span><span class="line" line="3"><span class="sybYZ">  &lt;/</span><span class="s-bR0">div</span><span class="sybYZ">&gt;
</span></span><span class="line" line="4"><span class="sybYZ">  &lt;</span><span class="sRd-J">loading</span><span class="sybYZ">&gt;&lt;/</span><span class="sRd-J">loading</span><span class="sybYZ">&gt;
</span></span></code><!--]--></pre><pre class="language-js shiki shiki-themes github-dark vitesse-dark" style=""><!--[--><code><span class="line" line="1"><span class="s8I54">const</span><span class="sXTEK"> ob</span><span class="soRP2"> =</span><span class="s8I54"> new</span><span class="scd8n"> IntersectionObserver</span><span class="sybYZ">(
</span></span><span class="line" line="2"><span class="sSfpy">  entries</span><span class="soRP2"> =&gt;</span><span class="sybYZ"> {
</span></span><span class="line" line="3"><span class="scBr_">    if</span><span class="sybYZ"> (</span><span class="sVbU4">entries</span><span class="sybYZ">[</span><span class="svno3">0</span><span class="sybYZ">].</span><span class="sVbU4">isIntersecting</span><span class="sybYZ">)</span><span class="sybYZ"> {
</span></span><span class="line" line="4"><span class="sKXKF">      // ...添加doms
</span></span><span class="line" line="5"><span class="sybYZ">    }
</span></span><span class="line" line="6"><span class="sybYZ">  },
</span></span><span class="line" line="7"><span class="sybYZ">  {
</span></span><span class="line" line="8"><span class="sqmIX">    root</span><span class="sybYZ">:</span><span class="smuiB"> null</span><span class="sybYZ">,
</span></span><span class="line" line="9"><span class="sqmIX">    rootMargin</span><span class="sybYZ">:</span><span class="sajHj"> &#39;</span><span class="sx1Rn">0</span><span class="sajHj">&#39;</span><span class="sybYZ">,
</span></span><span class="line" line="10"><span class="sqmIX">    threshold</span><span class="sybYZ">:</span><span class="svno3"> 0
</span></span><span class="line" line="11"><span class="sybYZ">  }
</span></span><span class="line" line="12"><span class="sybYZ">);
</span></span><span class="line" line="13"><span class="s8I54">const</span><span class="sXTEK"> loading</span><span class="soRP2"> =</span><span class="sVbU4"> document</span><span class="sybYZ">.</span><span class="scd8n">querySelector</span><span class="sybYZ">(</span><span class="sajHj">&#39;</span><span class="sx1Rn">.loading</span><span class="sajHj">&#39;</span><span class="sybYZ">);
</span></span><span class="line" line="14"><span class="sVbU4">ob</span><span class="sybYZ">.</span><span class="scd8n">observe</span><span class="sybYZ">(</span><span class="sVbU4">loading</span><span class="sybYZ">);
</span></span></code><!--]--></pre><style>html pre.shiki code .s8I54, html code.shiki .s8I54{--shiki-default:#F97583;--shiki-dark:#CB7676}html pre.shiki code .sXTEK, html code.shiki .sXTEK{--shiki-default:#79B8FF;--shiki-dark:#BD976A}html pre.shiki code .soRP2, html code.shiki .soRP2{--shiki-default:#F97583;--shiki-dark:#666666}html pre.shiki code .scd8n, html code.shiki .scd8n{--shiki-default:#B392F0;--shiki-dark:#80A665}html pre.shiki code .sybYZ, html code.shiki .sybYZ{--shiki-default:#E1E4E8;--shiki-dark:#666666}html pre.shiki code .sVbU4, html code.shiki .sVbU4{--shiki-default:#E1E4E8;--shiki-dark:#BD976A}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s3iJD, html code.shiki .s3iJD{--shiki-default:#B392F0;--shiki-dark:#5DA994}html pre.shiki code .sSfpy, html code.shiki .sSfpy{--shiki-default:#FFAB70;--shiki-dark:#BD976A}html pre.shiki code .s3cgb, html code.shiki .s3cgb{--shiki-default:#E1E4E8;--shiki-dark:#DBD7CAEE}html pre.shiki code .scBr_, html code.shiki .scBr_{--shiki-default:#F97583;--shiki-dark:#4D9375}html pre.shiki code .sKXKF, html code.shiki .sKXKF{--shiki-default:#6A737D;--shiki-dark:#758575DD}html pre.shiki code .s-bR0, html code.shiki .s-bR0{--shiki-default:#85E89D;--shiki-dark:#4D9375}html pre.shiki code .skT8L, html code.shiki .skT8L{--shiki-default:#B392F0;--shiki-dark:#BD976A}html pre.shiki code .sajHj, html code.shiki .sajHj{--shiki-default:#9ECBFF;--shiki-dark:#C98A7D77}html pre.shiki code .sx1Rn, html code.shiki .sx1Rn{--shiki-default:#9ECBFF;--shiki-dark:#C98A7D}html pre.shiki code .sqmIX, html code.shiki .sqmIX{--shiki-default:#E1E4E8;--shiki-dark:#B8A965}html pre.shiki code .smuiB, html code.shiki .smuiB{--shiki-default:#79B8FF;--shiki-dark:#CB7676}html pre.shiki code .svno3, html code.shiki .svno3{--shiki-default:#79B8FF;--shiki-dark:#4C9A91}html pre.shiki code .sRd-J, html code.shiki .sRd-J{--shiki-default:#FDAEB7;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:inherit}</style></article><div class="font-mono opacity-50 hover:opacity-90 cursor-pointer my-5"><span class="">&gt; </span><a href="/blog" class="">CD..</a></div><!--]--></div><!--]--><!--]--></div><div class="h-32"></div><footer class="limit py-8 text-sm text-dimmed text-center"><a href="https://beian.miit.gov.cn/" target="_blank" class="flex justify-center items-center gap-2"><span>蜀ICP备2023031823号</span><span>Powered by Seikonn</span></a></footer><!--]--><!--]--><!--[--><!--]--><!----><!--]--><!--[--><!--]--><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/202504/intersectionobserver-watch-dom/_payload.json?c64855ae-f368-40ba-a374-4b3dd8e64b35">[{"state":1,"once":8,"_errors":9,"serverRendered":5,"path":11,"prerenderedAt":12},["Reactive",2],{"$scolor-mode":3,"$stoasts":7},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,[],["Set"],["ShallowReactive",10],{"/blog/202504/intersectionobserver-watch-dom":-1},"/blog/202504/intersectionobserver-watch-dom",1746757448403]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},preview:{api:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"c64855ae-f368-40ba-a374-4b3dd8e64b35",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>